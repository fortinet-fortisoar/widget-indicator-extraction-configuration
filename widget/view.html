<!-- Copyright start
  MIT License
  Copyright (c) 2024 Fortinet Inc
  Copyright end -->

<link rel="stylesheet" type="text/css" href="{{widgetCSS}}" />
<div class="modal-header">
    <h3 class="modal-title col-md-9">{{viewWidgetVars.LABEL_TITLE}}</h3>
</div>
<wizard on-finish="close()" indicators-position="top" class="cs-wizard ingestion-steps ioc-extraction-config-steps"
    name="configureIndicatorExtraction">
    <wz-step wz-title="{{viewWidgetVars.START_PAGE_WZ_TITLE}}" wz-order="1"
        class="ingestion-modal-padding wizard-first-step">
        <div class="full-width wz-step-height padding-bottom-md solutionpack-wizard-modal-body">
            <div class="full-height overflow-auto">
                <div class="display-table fixed-table-layout full-height full-width">
                    <div class="full-height display-table-cell vertical-align-middle">
                        <div class="col-md-6 display-flex align-items-center margin-top-34 padding-0">
                            <div class="full-width">
                                <img class="img-responsive d-info-image" src="{{startPageImage}}">
                            </div>
                        </div>
                        <div class="col-md-6 prerequisites-section padding-bottom-25 padding-left-0">
                            <div class="font-size-40 line-height-1">{{viewWidgetVars.START_PAGE_TITLE}}</div><br />
                            <div class="margin-top-sm padding-right-30" style="max-width: 650px;">
                                <p class="font-size-14 margin-bottom-0">{{viewWidgetVars.START_PAGE_DESCRIPTION}}</p>
                            </div>
                        </div>
                        <button type="button"
                            class="btn btn-primary btn-sm margin-top-xlg text-transform-none font-size-14"
                            data-ng-click="moveNext()" id="solutionpack-next-btn">{{viewWidgetVars.START_PAGE_BUTTON}}<i
                                class="fa fa-chevron-right margin-left-sm"></i></button>
                    </div>
                </div>
            </div>
        </div>
        </div>
    </wz-step>
    <wz-step wz-title="{{viewWidgetVars.EXCLUDELIST_CONFIG_PAGE_WZ_TITLE}}" wz-order="2"
        class="ingestion-modal-padding">
        <div class="full-width wz-step-height padding-bottom-md solutionpack-wizard-modal-body">
            <div class="full-height overflow-auto">
                <div class="display-table fixed-table-layout full-height full-width">
                    <div class="full-height display-table-cell vertical-align-middle">
                        <div class="col-md-5 full-height padding-bottom-md"
                            style="padding-left: 8%; padding-top: 150px; padding-right: 150px;">
                            <div class="full-width">
                                <img class="img-responsive d-info-image" src="{{excludeIOCPageImage}}">
                            </div>
                        </div>
                        <div class="col-md-7 config-section">
                            <div style="border:2px solid; border-color: #29323e;" class="padding-20">
                                <div class="font-size-25">{{viewWidgetVars.EXCLUDELIST_CONFIG_PAGE_TITLE}}</div>
                                <div class="padding-right-30 margin-top-sm max-width-450px">
                                    <p class="font-size-14 grey-text margin-bottom-0 z-index-0">
                                        {{viewWidgetVars.EXCLUDELIST_CONFIG_PAGE_DESCRIPTION}}</p>
                                </div><br />
                                <div class="margin-right-lg margin-top-md position-relative filterSearch">
                                    <span
                                        class="font-075em icon icon-search margin-left-md margin-top-11 position-absolute right-10" data-ng-click="setSearchStatus('on')" data-ng-if="searchStatus === 'off'"></span>
                                    <span class="icon icon-close margin-top-md position-absolute right-10"
                                        data-ng-click="setSearchStatus('off')" data-ng-if="searchStatus === 'on'"></span>
                                    <input id="search" type="text" class="form-control padding-right-30"
                                        placeholder="Search Excluded Indicator" aria-labelledby="search-btn"
                                        data-ng-model="searchString" aria-invalid="false"
                                        data-ng-change="updateSearchQuery(searchString)">
                                </div>
                                <div class="padding-bottom-md padding-right-lg padding-top-sm filterContent"
                                    data-ng-if="searchString.length > 0 && searchStatus === 'on'">
                                    <div data-ng-repeat="item in globalSearchList | filter:searchString"
                                        class="align-items-start margin-top-sm display-flex margin-bottom-sm">
                                        <input type="checkbox" class="margin-left-sm margin-right-md"
                                            name="select-type-{{iocValue}}" id="select-type-{{iocValue}}"></input>
                                        <label for="select-type-{{iocValue}}"
                                            class="font-size-12 muted labelClass">{{item.iocValue}} ->
                                            {{item.type}}</label>
                                    </div>
                                </div>
                                <div data-ng-repeat="(keyStoreName, keyStoreDetails) in updatedGlobalSettings" class="excluded-ui-select">
                                    <div class="padding-bottom-md">
                                        <label
                                            class="control-label text-transform-none">{{keyStoreDetails.type}}:
                                            <span
                                                data-uib-tooltip="Specify {{keyStoreDetails.type}} to exclude from enrichment."
                                                data-tooltip-placement="top-left" data-tooltip-append-to-body="true"><i
                                                    class="icon icon-information" aria-hidden="true"></i></span>
                                        </label>
                                        <div class="cs-select padding-left-3">
                                            <ui-select name="{{keyStoreName}}"
                                                data-ng-model="keyStoreDetails.recordValue"
                                                multiple class="custom-multi-select" tagging="undefined"
                                                tagging-label="false"
                                                data-ng-change="validateIOC($select.selected, keyStoreName)">
                                                <ui-select-match
                                                    placeholder="Excluded {{keyStoreDetails.type}}">{{$item}}</ui-select-match>
                                                <ui-select-choices repeat="option in initList" refresh-delay="0"
                                                    show="(initList.length > 0)">
                                                    <div ng-bind="option"></div>
                                                </ui-select-choices>
                                            </ui-select>
                                            <span class="font-075em padding-left-10 text-danger"
                                                data-ng-if="invalidIOCs[keyStoreName].length > 0">Invalid {{keyStoreDetails.type}} - <strong>{{invalidIOCs[keyStoreName]}}</strong>
                                            </span>
                                        </div>
                                    </div>
                                </div>
                                <!-- <div data-ng-if="searchStatus === 'off'">
                                    <div class="padding-bottom-md">
                                        <label
                                            class="control-label text-transform-none">{{viewWidgetVars.EXCLUDELIST_CONFIG_PAGE_IP_ADDRESS_LABEL}}:
                                            <span
                                                data-uib-tooltip="{{viewWidgetVars.EXCLUDELIST_CONFIG_PAGE_IP_ADDRESS_TOOLTIP}}"
                                                data-tooltip-placement="top-left" data-tooltip-append-to-body="true"><i
                                                    class="icon icon-information" aria-hidden="true"></i></span>
                                        </label>
                                        <div class="cs-select padding-left-3">
                                            <ui-select name="excludedIPList"
                                                data-ng-model="updatedGlobalSettings['sfsp-excludelist-ips'].recordValue"
                                                multiple class="custom-multi-select" tagging="undefined"
                                                tagging-label="false"
                                                data-ng-change="validateIOC($select.selected, 'sfsp-excludelist-ips')">
                                                <ui-select-match
                                                    placeholder="{{viewWidgetVars.EXCLUDELIST_CONFIG_PAGE_IP_ADDRESS_PLACEHOLDER}}">{{$item}}</ui-select-match>
                                                <ui-select-choices repeat="option in initList" refresh-delay="0"
                                                    show="(initList.length > 0)">
                                                    <div ng-bind="option"></div>
                                                </ui-select-choices>
                                            </ui-select>
                                            <span class="font-075em padding-left-10 text-danger"
                                                data-ng-if="invalidIPs.length > 0">{{viewWidgetVars.EXCLUDELIST_CONFIG_PAGE_IP_ADDRESS_ERROR_MESSAGE}}<strong>{{invalidIPs}}</strong>
                                            </span>
                                        </div>
                                    </div>
                                </div>
                                <div data-ng-if="searchStatus === 'off'">
                                    <div class="padding-bottom-md">
                                        <label
                                            class="control-label text-transform-none">{{viewWidgetVars.EXCLUDELIST_CONFIG_PAGE_URL_LABEL}}:
                                            <span
                                                data-uib-tooltip="{{viewWidgetVars.EXCLUDELIST_CONFIG_PAGE_URL_TOOLTIP}}"
                                                data-tooltip-placement="top-left" data-tooltip-append-to-body="true"><i
                                                    class="icon icon-information" aria-hidden="true"></i></span>
                                        </label>
                                        <div class="cs-select padding-left-3">
                                            <ui-select name="excludedURLList"
                                                data-ng-model="updatedGlobalSettings['sfsp-excludelist-urls'].recordValue"
                                                multiple class="custom-multi-select" tagging="undefined"
                                                tagging-label="false"
                                                data-ng-change="validateIOC($select.selected, 'sfsp-excludelist-urls')">
                                                <ui-select-match
                                                    placeholder="{{viewWidgetVars.EXCLUDELIST_CONFIG_PAGE_URL_PLACEHOLDER}}">{{$item}}</ui-select-match>
                                                <ui-select-choices repeat="option in initList" refresh-delay="0"
                                                    show="(initList.length > 0)">
                                                    <div ng-bind="option"></div>
                                                </ui-select-choices>
                                            </ui-select>
                                            <span class="font-075em padding-left-10 text-danger"
                                                data-ng-if="invalidURLs.length > 0">{{viewWidgetVars.EXCLUDELIST_CONFIG_PAGE_URL_ERROR_MESSAGE}}<strong>{{invalidURLs}}</strong></span>
                                        </div>
                                    </div>
                                </div>
                                <div data-ng-if="searchStatus === 'off'">
                                    <div class="padding-bottom-md">
                                        <label
                                            class="control-label text-transform-none">{{viewWidgetVars.EXCLUDELIST_CONFIG_PAGE_DOMAIN_LABEL}}:
                                            <span
                                                data-uib-tooltip="{{viewWidgetVars.EXCLUDELIST_CONFIG_PAGE_DOMAIN_TOOLTIP}}"
                                                data-tooltip-placement="top-left" data-tooltip-append-to-body="true"><i
                                                    class="icon icon-information" aria-hidden="true"></i></span>
                                        </label>
                                        <div class="cs-select padding-left-3">
                                            <ui-select name="excludedDomainList"
                                                data-ng-model="updatedGlobalSettings['sfsp-excludelist-domains'].recordValue"
                                                multiple class="custom-multi-select" tagging="undefined"
                                                tagging-label="false"
                                                data-ng-change="validateIOC($select.selected, 'sfsp-excludelist-domains')">
                                                <ui-select-match
                                                    placeholder="{{viewWidgetVars.EXCLUDELIST_CONFIG_PAGE_DOMAIN_PLACEHOLDER}}">{{$item}}</ui-select-match>
                                                <ui-select-choices repeat="option in initList" refresh-delay="0"
                                                    show="(initList.length > 0)">
                                                    <div ng-bind="option"></div>
                                                </ui-select-choices>
                                            </ui-select>
                                            <span class="font-075em padding-left-10 text-danger"
                                                data-ng-if="invalidDomains.length > 0">{{viewWidgetVars.EXCLUDELIST_CONFIG_PAGE_DOMAIN_ERROR_MESSAGE}}<strong>{{invalidDomains}}</strong></span>
                                        </div>
                                    </div>
                                </div>
                                <div data-ng-if="searchStatus === 'off'">
                                    <div class="padding-bottom-md">
                                        <label
                                            class="control-label text-transform-none">{{viewWidgetVars.EXCLUDELIST_CONFIG_PAGE_PORTS_LABEL}}:
                                            <span
                                                data-uib-tooltip="{{viewWidgetVars.EXCLUDELIST_CONFIG_PAGE_PORTS_TOOLTIP}}"
                                                data-tooltip-placement="top-left" data-tooltip-append-to-body="true"><i
                                                    class="icon icon-information" aria-hidden="true"></i></span>
                                        </label>
                                        <div class="cs-select padding-left-3">
                                            <ui-select name="excludedPortList"
                                                data-ng-model="updatedGlobalSettings['sfsp-excludelist-ports'].recordValue"
                                                multiple class="custom-multi-select" tagging="undefined"
                                                tagging-label="false"
                                                data-ng-change="validateIOC($select.selected, 'sfsp-excludelist-ports')">
                                                <ui-select-match
                                                    placeholder="{{viewWidgetVars.EXCLUDELIST_CONFIG_PAGE_PORTS_PLACEHOLDER}}">{{$item}}</ui-select-match>
                                                <ui-select-choices repeat="option in initList" refresh-delay="0"
                                                    show="(initList.length > 0)">
                                                    <div ng-bind="option"></div>
                                                </ui-select-choices>
                                            </ui-select>
                                            <span class="font-075em padding-left-10 text-danger"
                                                data-ng-if="invalidPorts.length > 0">{{viewWidgetVars.EXCLUDELIST_CONFIG_PAGE_PORTS_ERROR_MESSAGE}}<strong>{{invalidPorts}}</strong></span>
                                        </div>
                                    </div>
                                </div>
                                <div data-ng-if="searchStatus === 'off'">
                                    <div class="padding-bottom-md">
                                        <label
                                            class="control-label text-transform-none">{{viewWidgetVars.EXCLUDELIST_CONFIG_PAGE_FILES_LABEL}}:
                                            <span
                                                data-uib-tooltip="{{viewWidgetVars.EXCLUDELIST_CONFIG_PAGE_FILES_TOOLTIP}}"
                                                data-tooltip-placement="top-left" data-tooltip-append-to-body="true"><i
                                                    class="icon icon-information" aria-hidden="true"></i></span>
                                        </label>
                                        <div class="cs-select padding-left-3">
                                            <ui-select name="excludedFilesList"
                                                data-ng-model="updatedGlobalSettings['sfsp-excludelist-files'].recordValue"
                                                multiple class="custom-multi-select" tagging="undefined"
                                                tagging-label="false"
                                                data-ng-change="validateIOC($select.selected, 'sfsp-excludelist-files')">
                                                <ui-select-match
                                                    placeholder="{{viewWidgetVars.EXCLUDELIST_CONFIG_PAGE_FILES_PLACEHOLDER}}">{{$item}}</ui-select-match>
                                                <ui-select-choices repeat="option in initList" refresh-delay="0"
                                                    show="(initList.length > 0)">
                                                    <div ng-bind="option"></div>
                                                </ui-select-choices>
                                            </ui-select>
                                        </div>
                                    </div>
                                </div>
                                <div data-ng-if="searchStatus === 'off'">
                                    <div class="padding-bottom-md">
                                        <label
                                            class="control-label text-transform-none">{{viewWidgetVars.EXCLUDELIST_CONFIG_PAGE_CIDR_LABEL}}:
                                            <span
                                                data-uib-tooltip="{{viewWidgetVars.EXCLUDELIST_CONFIG_PAGE_CIDR_TOOLTIP}}"
                                                data-tooltip-placement="top-left" data-tooltip-append-to-body="true"><i
                                                    class="icon icon-information" aria-hidden="true"></i></span>
                                        </label>
                                        <div class="cs-select padding-left-3">
                                            <ui-select name="excludedCIDRList"
                                                data-ng-model="updatedGlobalSettings['sfsp-excludelist-cidr-ranges'].recordValue"
                                                multiple class="custom-multi-select" tagging="undefined"
                                                tagging-label="false"
                                                data-ng-change="validateIOC($select.selected, 'sfsp-excludelist-cidr-ranges')">
                                                <ui-select-match
                                                    placeholder="{{viewWidgetVars.EXCLUDELIST_CONFIG_PAGE_CIDR_PLACEHOLDER}}">{{$item}}</ui-select-match>
                                                <ui-select-choices repeat="option in initList" refresh-delay="0"
                                                    show="(initList.length > 0)">
                                                    <div ng-bind="option"></div>
                                                </ui-select-choices>
                                            </ui-select>
                                            <span class="font-075em padding-left-10 text-danger"
                                                data-ng-if="invalidCIDRs.length > 0">{{viewWidgetVars.EXCLUDELIST_CONFIG_PAGE_CIDR_ERROR_MESSAGE}}<strong>{{invalidCIDRs}}</strong></span>
                                        </div>
                                    </div>
                                </div> -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="ingestion-modal-footer">
                <button type="button" class="btn btn-sm btn-second-primary margin-top-lg margin-left-lg"
                    id="solutionpack-configure-back-env-btn" data-ng-click="moveBack()"><i
                        class="fa fa-chevron-left margin-right-sm"></i>{{viewWidgetVars.EXCLUDELIST_CONFIG_PAGE_BACK_BUTTON}}</button>
                <button type="button" class="btn btn-primary pull-right btn-sm margin-top-lg margin-right-lg"
                    data-ng-click="moveNext()" id="solutionpack-configure-env-next-btn"
                    data-ng-disabled="isInvalidIOCsNotEmpty()">{{viewWidgetVars.EXCLUDELIST_CONFIG_PAGE_NEXT_BUTTON}}<i
                        class="fa fa-chevron-right margin-left-sm"></i>
                </button>
            </div>
    </wz-step>
    <wz-step wz-title="Finish" wz-order="3" class="ingestion-modal-padding wizard-first-step">
        <div class="full-width wz-step-height padding-bottom-md solutionpack-wizard-modal-body">
            <div class="full-height">
                <div class="display-table fixed-table-layout full-height full-width">
                    <div class="full-height display-table-cell vertical-align-middle">
                        <div class="col-md-6 display-flex align-items-center margin-top-34 padding-0">
                            <div class="full-width">
                                <img class="img-responsive d-info-image" src="{{finishPageImage}}">
                            </div>
                        </div>
                        <div class="col-md-6 prerequisites-section padding-bottom-25 padding-left-0">
                            <div class="font-size-35">FortiAI Configuration Summary</div>
                            <p class="font-size-14 margin-bottom-0">All prerequisites have been configured successfully.
                            </p><br />
                            <p class="margin-bottom-0">Quick Summary.</p>
                            <div style="margin-left: -17px;padding-top: 7px;">
                                <ul>
                                    <li><span class="grey-text padding-bottom-3">LLM Integration:
                                        </span><span>{{defaultLLMIntegration.title}}</span></li>
                                    <li><span class="grey-text padding-bottom-3">Conversation Model:
                                        </span><span>{{defaultLLMIntegration.conversationModel}}</span></li>
                                    <li><span class="grey-text padding-bottom-3">Playbook Generation Model:
                                        </span><span>{{defaultLLMIntegration.pBGenerationModel}}</span></li>
                                    <li><span class="grey-text padding-bottom-3">Enable Multi User Configuration:
                                        </span><span
                                            style="text-transform: capitalize;">{{defaultLLMIntegration.isMultiConfigAvailable}}</span>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="ingestion-modal-footer">
            <button type="button" class="btn btn-sm btn-second-primary margin-top-lg margin-left-lg"
                id="solutionpack-configure-back-env-btn" data-ng-click="moveBack()"><i
                    class="fa fa-chevron-left margin-right-sm"></i>Back</button>
            <button type="button" class="btn btn-primary pull-right btn-sm margin-top-lg margin-right-lg"
                data-ng-click="moveNext()" id="solutionpack-configure-env-next-btn">Finish<i
                    class="fa fa-chevron-right margin-left-sm"></i>
            </button>
        </div>
    </wz-step>
</wizard>